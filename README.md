Домашнее задание к занятию "3.6. Компьютерные сети, лекция 1"

1. Необязательное задание: можно посмотреть целый фильм в консоли telnet towel.blinkenlights.nl :)
```
Посмотрел, теперь есть чем удивить коллег)
```

2. Узнайте о том, сколько действительно независимых (не пересекающихся) каналов есть в разделяемой среде WiFi при работе на 2.4 ГГц. Стандарты с полосой 5 ГГц более актуальны, но регламенты на 5 ГГц существенно различаются в разных странах, а так же не раз обновлялись. В качестве дополнительного вопроса вне зачета, попробуйте найти актуальный ответ и на этот вопрос.
```
Теоретически в частоте 2.4гц при ширине канала 20Гц (это ширина по умолчанию, бывает и 10 и 40, но одна слишком узкая,  другая слишком широкая) не пересекающиеся каналы это 1, 6, 11. Но на практике вылезает очень много нюансов, если хотите, могу отдельно про это написать, но это уже будет вне темы вопроса).

Касаемо 5Ггц, согласен, это частота зарегулирована гораздо сильнее чем 2ГГц, более того использование этой частоты в РФ для построения радиоканалов на открытых территориях без лицензии запрещено и так далее
```

3. Адрес канального уровня – MAC адрес – это 6 байт, первые 3 из которых называются OUI – Organizationally Unique Identifier или уникальный идентификатор организации. Какому производителю принадлежит MAC 38:f9:d3:55:55:79?
```
Apple, Inc.
```

4. Каким будет payload TCP сегмента, если Ethernet MTU задан в 9001 байт, размер заголовков IPv4 – 20 байт, а TCP – 32 байта?
```
 MTU (максимальный размер пакета) - (заголовоки  IPv4 + TCP) = MSS (максимальный размер сегмента)

9001 - (20 + 32) = 8949 
```

5. Может ли во флагах TCP одновременно быть установлены флаги SYN и FIN при штатном режиме работы сети? Почему да или нет?
```
Нет,  потому что флаг SYN начинает соединение, а FIN сообщает, что все пакеты были отправлены.  Пакет не может быть в обоих состояниях одновременно.
```

6. ss -ula sport = :53 на хосте имеет следующий вывод:
```
State           Recv-Q          Send-Q                   Local Address:Port                     Peer Address:Port          Process
UNCONN          0               0                        127.0.0.53%lo:domain                        0.0.0.0:*
```
Почему в State присутствует только UNCONN, и может ли там присутствовать, например, TIME-WAIT?

```
Ключ -u выводит UDP советы, колонка State для UDP пакетов либо UNCONN (нет соединения), либо эта колонка просто пуская, так как UDP является протоколом без установления соединения и следовательно, не имеет состояний, подобных состояниям TCP, следовательно и состояния TIME-WAIT быть не может.
```

7. Обладая знаниями о том, как штатным образом завершается соединение (FIN от инициатора, FIN-ACK от ответчика, ACK от инициатора), опишите в каких состояниях будет находиться TCP соединение в каждый момент времени на клиенте и на сервере при завершении. Схема переходов состояния соединения вам в этом поможет.

Initiator

Receiver

FIN
FIN WAIT 1
->
CLOSE WAIT (passive close)
<-
FIN ACK
FIN WAIT 2
->
LAST ACK
<-
ACK
TIME WAIT
->
CLOSED


8. TCP порт – 16 битное число. Предположим, 2 находящихся в одной сети хоста устанавливают между собой соединения. Каким будет теоретическое максимальное число соединений, ограниченное только лишь параметрами L4, которое параллельно может установить клиент с одного IP адреса к серверу с одним IP адресом? Сколько соединений сможет обслужить сервер от одного клиента? А если клиентов больше одного?
```
Максимальное число портов 65535. И в таблице соединений должна быть уникальной пара IP:Port -> IP:Port. Следовательно на каждого клиента может быть не более 65535 соединений.
```

9. Может ли сложиться ситуация, при которой большое число соединений TCP на хосте находятся в состоянии TIME-WAIT? Если да, то является ли она хорошей или плохой? Подкрепите свой ответ пояснением той или иной оценки.
```
Если слишком много подключений в состоянии TIME_WAIT, то каждое подключение в состоянии TIME_WAIT потребляет некоторое количество памяти в ядре и это может увеличить нагрузку на сервер.
```

10. Чем особенно плоха фрагментация UDP относительно фрагментации TCP?

TCP и UDP-пакеты заворачиваются (инкапсулируются) в IP пакет.  И фрагментация пакетов происходит на уровне протокола IP. Но, протокол UDP гарантирует передачу пакетов, то приход их адресату не гарантируется (как и их очерёдность), ниже цитата из книги O'Reilly TCP/IP Network Administration:
```

Глава 1: Обзор TCP/IP: 1.6 Транспортный уровень: 1.6.1 Протокол пользовательских дейтаграмм... UDP - это ненадежный протокол дейтаграмм без установления соединения. Как отмечалось ранее, "ненадежный" просто означает, что в протоколе нет методов проверки правильности передачи данных на другой конец сети.
```
Следовательно разницы между фрагментациями UDP и TCP нет, есть лишь разница в гарантии доставки пакетов до адресата.

11. Если бы вы строили систему удаленного сбора логов, то есть систему, в которой несколько хостов отправляют на центральный узел генерируемые приложениями логи (предположим, что логи – текстовая информация), какой протокол транспортного уровня вы выбрали бы и почему? Проверьте ваше предположение самостоятельно, узнав о стандартном протоколе syslog.

Я бы однозначно использовал TCP, так как у него есть механизм гарантированной доставки пакетов, в случае с сервисов Syslog это очень важно.
Цитата из документации CItrix:
```
Syslog изначально предназначен для работы по протоколу UDP, что позволяет передавать огромное количество данных внутри одной сети с минимальной потерей пакетов. Однако операторы связи предпочитают передавать данные системного журнала по протоколу TCP, поскольку им необходима надежная и упорядоченная передача данных между сетями. Например, телекоммуникационная компания отслеживает действия пользователей, а TCP обеспечивает повторную передачу в случае сбоя в сети.
```

12. Сколько портов TCP находится в состоянии прослушивания на вашей виртуальной машине с Ubuntu, и каким процессам они принадлежат?
```
vagrant@netology:~$ sudo ss state listening -t -p 
Recv-Q      Send-Q           Local Address:Port               Peer Address:Port      Process 
0           4096             127.0.0.53%lo:domain                  0.0.0.0:*          users:(("systemd-resolve",pid=606,fd=13)) 
0           128                    0.0.0.0:ssh                     0.0.0.0:*          users:(("sshd",pid=696,fd=3)) 
0           4096                 127.0.0.1:8125                    0.0.0.0:*          users:(("netdata",pid=637,fd=48)) 
0           4096                   0.0.0.0:19999                   0.0.0.0:*          users:(("netdata",pid=637,fd=5)) 
0           128                       [::]:ssh                        [::]:*          users:(("sshd",pid=696,fd=4)) 
0           4096                      [::]:19999                      [::]:*          users:(("netdata",pid=637,fd=6))
```

13. Какой ключ нужно добавить в tcpdump, чтобы он начал выводить не только заголовки, но и содержимое фреймов в текстовом виде? А в текстовом и шестнадцатиричном?

В текстовом ASCII 
```
sudo tcpdump -A -i eth0
```

В текстовом ASCII и шестнадцатиричном HEX
```
sudo tcpdump -XX -i eth0
```

14. Попробуйте собрать дамп трафика с помощью tcpdump на основном интерфейсе вашей виртуальной машины и посмотреть его через tshark или Wireshark (можно ограничить число пакетов -c 100). Встретились ли вам какие-то установленные флаги Internet Protocol (не флаги TCP, а флаги IP)? Узнайте, какие флаги бывают. Как на самом деле называется стандарт Ethernet, фреймы которого попали в ваш дамп? Можно ли где-то в дампе увидеть OUI?

Встретились ли вам какие-то установленные флаги Internet Protocol:
```
Flags: 0x40, Don't fragment
0... .... = Reserved bit: Not set
.1.. .... = Don't fragment: Set
..0. .... = More fragments: Not set
...0 0000 0000 0000 = Fragment Offset: 0
```

Узнайте, какие флаги бывают:
```
Бит 0: зарезервирован и должен быть установлен на ноль 
Бит 1: означает не фрагментировать 
Бит 2: означает больше фрагментов.
```

Можно ли где-то в дампе увидеть OUI?
Вот оно:
```
Ethernet II, Src: 0a:00:27:00:00:17 (0a:00:27:00:00:17), Dst: PcsCompu_10:e3:d3 (08:00:27:10:e3:d3)

Dst: PcsCompu_10:e3:d3
```

Как на самом деле называется стандарт Ethernet
```
Ethernet II
```
